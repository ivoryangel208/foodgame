import random
import time

class Game:
    def __init__(self):
        self.fish_count = 0
        self.meal_count = 0
        self.coins = 0
        self.fishing_level = 1
        self.crop_count = 0
        self.locations = ['Home', 'River', 'Town', 'Forest']
        self.current_location = 0
        self.fish_types = ['🐟', '🐠', '🐡', '🦈', '🐋', '🎣']
        self.species = ['Salmon', 'Trout', 'Bass', 'Pike', 'Shark', 'Whale']
        self.animals = ['Dog', 'Cat', 'Rabbit', 'Horse', 'Cow']
        self.crops = ['Corn', 'Carrot', 'Tomato', 'Potato', 'Wheat']
        self.npcs = ['Villager', 'Merchant', 'Farmer', 'Cook', 'Explorer']

        # Logging dictionaries
        self.fish_log = []
        self.animal_log = []
        self.crop_log = []
        self.transaction_log = []

    def display_inventory(self):
        print("\nInventory:")
        print(f"Fish: {self.fish_count}")
        print(f"Meals: {self.meal_count}")
        print(f"Coins: {self.coins}")
        print(f"Fishing Level: {self.fishing_level}")
        print(f"Crops: {self.crop_count}")
        print(f"Location: {self.locations[self.current_location]}")
        print("-" * 30)

    def log_catch(self, fish, weight, length, rarity, price, description, nickname):
        self.fish_log.append({
            "Fish": fish,
            "Weight": weight,
            "Length": length,
            "Rarity": rarity,
            "Price": price,
            "Description": description,
            "Nickname": nickname
        })
        print(f"{fish} caught! Added to log.")

    def catch_fish(self):
        fish = random.choice(self.fish_types)
        species = random.choice(self.species)
        weight = round(random.uniform(1, 50), 2)
        length = round(random.uniform(10, 200), 2)
        rarity = random.choice(['Common', 'Uncommon', 'Rare', 'Legendary'])
        price = round(random.uniform(10, 100), 2)
        description = f"A wild {species} fish."
        nickname = f"{fish}_{random.randint(1, 100)}"
        
        self.fish_count += 1
        self.log_catch(fish, weight, length, rarity, price, description, nickname)

    def cook_food(self):
        if self.fish_count > 0:
            self.meal_count += 1
            self.fish_count -= 1
            print("You cooked a meal!")
        else:
            print("You need more fish to cook!")

    def sell_food(self):
        if self.meal_count > 0:
            self.coins += 5 * self.meal_count
            self.meal_count = 0
            self.transaction_log.append(f"Sold meals for {5 * self.meal_count} coins.")
            print("You sold your meals!")
        else:
            print("You have no food to sell!")

    def buy_upgrade(self):
        if self.coins >= 20:
            self.coins -= 20
            self.fishing_level += 1
            print(f"Your fishing level increased to {self.fishing_level}!")
        else:
            print("Not enough coins for an upgrade!")

    def farm_crops(self):
        crop = random.choice(self.crops)
        self.crop_count += 1
        self.crop_log.append(f"Farmed a {crop}.")
        print(f"You farmed a {crop}!")

    def travel(self):
        self.current_location = (self.current_location + 1) % len(self.locations)
        print(f"You traveled to {self.locations[self.current_location]}!")

    def interact_with_npc(self):
        npc = random.choice(self.npcs)
        print(f"You interacted with {npc}.")

    def enter_contest(self):
        if self.meal_count > 0:
            success = random.choice([True, False])
            if success:
                self.coins += 50
                print("You won the cooking contest! Prize: 50 coins!")
            else:
                print("You lost the contest, better luck next time!")
        else:
            print("You need a meal to enter the contest!")

    def display_game_log(self):
        print("\n--- Game Logs ---")
        print("Fish Catches:")
        for log in self.fish_log:
            print(log)
        print("Animal Catches:")
        for log in self.animal_log:
            print(log)
        print("Crop Harvests:")
        for log in self.crop_log:
            print(log)
        print("Transactions:")
        for log in self.transaction_log:
            print(log)
        print("-" * 30)

    def start(self):
        while True:
            self.display_inventory()
            action = input("\nWhat would you like to do? (Fish, Cook, Sell, Buy Upgrade, Farm, Travel, NPC, Contest, Log, Quit): ").strip().lower()

            if action == "fish":
                self.catch_fish()
            elif action == "cook":
                self.cook_food()
            elif action == "sell":
                self.sell_food()
            elif action == "buy upgrade":
                self.buy_upgrade()
            elif action == "farm":
                self.farm_crops()
            elif action == "travel":
                self.travel()
            elif action == "npc":
                self.interact_with_npc()
            elif action == "contest":
                self.enter_contest()
            elif action == "log":
                self.display_game_log()
            elif action == "quit":
                print("Thanks for playing!")
                break
            else:
                print("Invalid action. Please try again.")

if __name__ == "__main__":
    game = Game()
    game.start()
